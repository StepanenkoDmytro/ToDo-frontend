<div class="card">
    <div class="card-header">
        Список задач
    </div>
    <div class="card-body table-responsive" *ngIf="tasks && tasks.length > 0">
        <table [dataSource]="dataSource" mat-table matSort>

            <ng-container matColumnDef="color">
                <th mat-header-cell *matHeaderCellDef></th>
                <td mat-cell 
                    *matCellDef="let task" 
                    class="col-color"
                    [style.background-color]="getPriorityColor(task)">
                </td>
            </ng-container>
            
            <ng-container matColumnDef="id">
                <th mat-header-cell *matHeaderCellDef>#</th>
                <td mat-cell 
                    *matCellDef="let index = index"
                    class="col-id">
                    {{ index + 1 }}
                </td>
            </ng-container>
            
            <ng-container matColumnDef="title">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Завдання</th>
                <td mat-cell 
                    *matCellDef="let task" 
                    class="col-title"
                    [class.completed]="task.completed"
                    (click)="openEditTaskDialog(task)">
                        {{ task.title }}
                </td>
            </ng-container>

            <ng-container matColumnDef="date">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Дата</th>
                <td mat-cell 
                    *matCellDef="let task" 
                    class="col-date"
                    [class.no-value]="!task.date">
                    {{ task.date | taskDate }}
                </td>
            </ng-container>
            
            <ng-container matColumnDef="category">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Категорія</th>
                <td mat-cell 
                    *matCellDef="let task" 
                    class="col-category"
                    [class.no-value]="!task.category">
                {{ task.category ? task.category.title : 'Немає категорії' }}
                </td>
            </ng-container>

            <ng-container matColumnDef="priority">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Приорітет</th>
                <td mat-cell 
                    *matCellDef="let task"
                    class="col-priority" 
                    [class.no-value]="!task.priority">
                    {{ task.priority ? task.priority.title : 'Немає пріорітету' }}
                </td>
            </ng-container>

            <ng-container matColumnDef="status">
                <th mat-header-cell *matHeaderCellDef>Статус</th>
                <td mat-cell 
                    *matCellDef="let task"
                    class="col-status">
                    <div class="form-check">
                        <input [checked]="task.completed"
                                (click)="toggleTaskCompleted(task)"
                                class="form-check-input" 
                                type="checkbox" 
                                value="" >
                    </div>
                </td>
            </ng-container>
            
            <tr mat-header-row 
                *matHeaderRowDef="displayedColumns">
            </tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;">
            </tr>
        </table>

        <mat-paginator [pageSizeOptions]="[10, 20, 50, 100]" showFirstLastButtons></mat-paginator>
    </div>

    <div *ngIf="tasks && tasks.length === 0">
        <p class="not-found">Нічого не знайдено</p>
    </div>
</div>
